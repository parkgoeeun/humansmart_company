function ajax_request(e){var t=new XMLHttpRequest;t.open("get",e),t.onreadystatechange=function(){4===t.readyState&&200===t.status&&$(".log").html(t.responseText)},t.send()}function filter(){return""==$("#txtFilter").val()?($(".subject").css("display",""),$(".content").css("display","")):($(".content").css("display","none"),$(".content[name*='"+$("#txtFilter").val()+"']").css("display","")),!1}function detailMode(e){var t={ModeNumber:e};$.ajax({type:"POST",url:"detailMode.php",data:t,success:function(e){$("#historyLog").html(e)}})}function changeDate(e){$(".changeSchedule_date").val(e)}function modifySchedule(e,t,a,l,n){a=1800==a?", 1회(30분)":3600==a?", 2회(60분)":5400==a?", 3회(90분)":7200==a?", 4회(120분)":"",$("#modifySchedule .changeTimeTitle").html(n+"님과의 실시간 상담 예약 변경 요청"),$("#modifySchedule .originalSchedule").html("기존 실시간 상담 예약 시간 : "+e+" "+t+a),$("#modifySchedule .numberOfRoom").val(l),$("#modifySchedule").fadeIn(),$(".opacityBg").fadeIn()}function alterSchedule(e,t,a,l){a=1800==a?", 1회(30분)":3600==a?", 2회(60분)":5400==a?", 3회(90분)":7200==a?", 4회(120분)":"",$("#changeSchedule .originalSchedule").html("기존 실시간 상담 예약 시간 : "+e+" "+t+a),$("#changeSchedule .numberOfRoom").val(l),$("#changeSchedule .changeDate").val(e+"|"+t),$("#changeSchedule").fadeIn(),$(".opacityBg").fadeIn()}$(function(){if("history"===linkType){$(".menuHistoryNow").click(function(){$("#historyNow").css("display",""),$("#historyLog").css("display","none")}),$(".menuHistoryLog").click(function(){$("#historyNow").css("display","none"),$("#historyLog").css("display","")}),$("#orderHistoryCounseling").data("options",$("#orderHistoryCounseling option")),historyDateLength=$("#orderHistoryCounting option").length,$("#orderHistoryCounting option").css("display","");for(var e=0;e<=historyDateLength;e++)$("#orderHistoryCounting option:eq("+e+")").val()!=$("#orderHistoryCounseling option:selected").val()&&$("#orderHistoryCounting option:eq("+e+")").css("display","none");$("#orderHistoryCounseling").change(function(){if($("#orderHistoryCounting option").css("display",""),"All"==$("#orderHistoryCounseling option:selected").val())ajax_request("/oauth/counseling/texttime/history/index.php?no="+counselingNo+"&status="+userStatus);else for(var e=0;e<=historyDateLength;e++)$("#orderHistoryCounting option:eq("+e+")").val()!=$("#orderHistoryCounseling option:selected").val()&&"All"!=$("#orderHistoryCounting option:eq("+e+")").val()&&$("#orderHistoryCounting option:eq("+e+")").css("display","none")}),$("#orderHistoryCounting").change(function(){var e=$("#orderHistoryCounting option:selected").html(),t=e.split(" - ");if("All"==$("#orderHistoryCounting option:selected").val()){var e=$("#orderHistoryCounting option:eq(1)").html(),t=e.split(" - "),a=$("#orderHistoryCounting option:eq("+(historyDateLength-1)+")").html(),l=a.split(" - ");ajax_request("/oauth/counseling/texttime/history/index.php?no="+counselingNo+"&status="+userStatus+"&from="+t[0]+"&to="+l[0])}else{var e=$("#orderHistoryCounting option:selected").html(),t=e.split(" - ");ajax_request("/oauth/counseling/texttime/history/index.php?no="+counselingNo+"&status="+userStatus+"&from="+t[0]+"&to="+t[0])}})}else"schedule"===linkType?($("#datepicker1, #datepicker2").datepicker({dateFormat:"yy-mm-dd",prevText:"이전 달",nextText:"다음 달",monthNames:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],monthNamesShort:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],dayNames:["일","월","화","수","목","금","토"],dayNamesShort:["일","월","화","수","목","금","토"],dayNamesMin:["일","월","화","수","목","금","토"],showMonthAfterYear:!0,yearSuffix:"년"}),$("#datepicker1, #datepicker2").change(function(){if(""==$("#datepicker1").val()||""==$("#datepicker2").val())$(".subject").css("display",""),$(".content").css("display","");else{$(".content").css("display","none");var e=$(".content[name]");if("client"===userStatus)for(var t=0;t<e.length;t++){var a=$(e[t]).attr("name");a>=$("#datepicker1").val()&&a<=$("#datepicker2").val()&&$(e[t]).css("display","")}else for(var t=0;t<e.length;t++){var a=$(e[t]).attr("name").split("/");a[1]>=$("#datepicker1").val()&&a[1]<=$("#datepicker2").val()&&$(e[t]).css("display","")}}})):("NORMAL"===signType&&$("p.tab_pw").css("display","block"),$("#withdrawalPopBtn").click(function(){$(".opacityBg").fadeIn(),$(".withdrawalAgree").fadeIn()}),$(".withdrawalAgree img").click(function(){$(".withdrawalAgree").fadeOut(),$(".opacityBg").fadeOut()}),$(".withdrawalAgree .withdrawalBtn").click(function(){if(!$("input[type=checkbox][name=withdrawal_terms]").is(":checked"))return alert("탈퇴 여부에 동의해주세요."),!1;if("NORMAL"===signType){var e=$("input[type=password][name=user_pw]").val();if(!e)return alert("기존 패스워드를 입력해주세요."),!1}else var e="";$.ajax({url:"/oauth/sign/",type:"POST",cache:!1,timeout:3e4,contentType:"application/json; charset=UTF-8",dataType:"json",data:JSON.stringify({id:userID,pw:e,type:"withdrawal"}),success:function(e){"Y"==e.result?(alert(e.msg),location.href="/auth/sign_out.php"):alert(e.msg)}})}))}),$("#orderCounseling").change(function(){if(5==$("#orderCounseling").val())return $(".content").css("display",""),!1;var e=new Date,t=e.getUTCMonth()+1,a=e.getUTCDate();10>t&&(t="0"+t),10>a&&(a="0"+a);var l=e.getUTCFullYear()+"-"+t+"-"+a;if(3==$("#orderCounseling").val()){e.setDate(e.getUTCDate()+7)}if(4==$("#orderCounseling").val()){e.setDate(e.getUTCDate()+30)}t=e.getUTCMonth()+1,a=e.getUTCDate(),10>t&&(t="0"+t),10>a&&(a="0"+a);var n=e.getUTCFullYear()+"-"+t+"-"+a;$("#datepicker1").val(l),$("#datepicker2").val(n),$("#datepicker1, #datepicker2").change()}),$(".cancelChange").click(function(){$("#changeSchedule").fadeOut(),$(".changeDate").val(""),$(".alterDate").val(""),$("#SchedulePrelist").val(""),$("#modifySchedule").fadeOut(),$(".alterDate1").val(""),$(".alterDate2").val(""),$(".alterDate3").val(""),$("#SchedulePrelist1").val(""),$("#SchedulePrelist2").val(""),$("#SchedulePrelist3").val(""),$(".opacityBg").fadeOut(),$(".numberOfRoom").val(""),$(".changeSchedule_date").val(""),$("#changeSchedule_timeFrom").val(""),$("#changeSchedule_timeto").val(""),$("#changeSchedule_plan").val("")}),$("#modifySchedule .AddSchedule").click(function(){var e=$("#modifySchedule .changeSchedule_date").val(),t=$("#modifySchedule #changeSchedule_timeFrom").val(),a=$("#modifySchedule #changeSchedule_timeto").val(),l=$("#modifySchedule #changeSchedule_plan").val();if(""===e||""===t||""===a||""===l)alert("모든 일정을 채워주시길 바랍니다.");else for(var n=e.split("-"),o=1;3>=o;o++)if(""==$("#modifySchedule #SchedulePrelist"+o).val()){$("#modifySchedule #SchedulePrelist"+o).val(o+"순위: "+n[0]+"년 "+n[1]+"월 "+n[2]+"일 "+t+"시 "+a+"분 / "+l+"분"),$("#modifySchedule .alterDate"+o).val(n[0]+"년 "+n[1]+"월 "+n[2]+"일 "+t+"시 "+a+"분, "+l+"분");break}}),$("#modifySchedule .DelSchedule1").click(function(){$("#modifySchedule #SchedulePrelist1").val(""),$("#modifySchedule .alterDate1").val("")}),$("#modifySchedule .DelSchedule2").click(function(){$("#modifySchedule #SchedulePrelist2").val(""),$("#modifySchedule .alterDate2").val("")}),$("#modifySchedule .DelSchedule3").click(function(){$("#modifySchedule #SchedulePrelist3").val(""),$("#modifySchedule .alterDate3").val("")}),$("button.modifyChange").click(function(){var e=$("#modifySchedule .numberOfRoom").val(),t=($("#modifySchedule .changeSchedule_date").val(),$("#modifySchedule #changeSchedule_timeFrom").val(),$("#modifySchedule #changeSchedule_timeto").val(),$("#modifySchedule #changeSchedule_plan").val(),$("#modifySchedule .alterDate1").val()),a=$("#modifySchedule .alterDate2").val(),l=$("#modifySchedule .alterDate3").val();""===t&&""===a&&""===l?alert("한 개 이상 변경 요청 일정을 작성해주세요."):$.ajax({url:"/oauth/counseling/texttime/reservation/",type:"POST",cache:!1,timeout:3e4,contentType:"application/json; charset=UTF-8",dataType:"json",data:JSON.stringify({type:"userModify",userType:"personal",bookingDate1:t,bookingDate2:a,bookingDate3:l,roomNumber:e,status:userStatus}),success:function(e){"Y"==e.result?(alert(e.msg),$("button.cancelChange").click()):alert(e.msg)}})}),$("#changeSchedule .AddSchedule").click(function(){var e=$("#changeSchedule .changeSchedule_date").val(),t=$("#changeSchedule #changeSchedule_timeFrom").val(),a=$("#changeSchedule #changeSchedule_timeto").val(),l=$("#changeSchedule #changeSchedule_plan").val();if(""===e||""===t||""===a||""===l)alert("모든 일정을 채워주시길 바랍니다.");else{var n=e.split("-");$("#changeSchedule #SchedulePrelist").val("변경 시간: "+n[0]+"년 "+n[1]+"월 "+n[2]+"일 "+t+"시 "+a+"분 / "+l+"분"),$("#changeSchedule .alterDate").val(e+"|"+t+":"+a)}}),$("#changeSchedule .DelSchedule").click(function(){$("#changeSchedule #SchedulePrelist").val("실시간 상담 예약 변경: "),$("#changeSchedule .alterDate").val("")}),$(".alterChange").click(function(){var e=$("#changeSchedule .numberOfRoom").val(),t=$("#changeSchedule .changeDate").val(),a=$("#changeSchedule .changeSchedule_date").val(),l=$("#changeSchedule #changeSchedule_timeFrom").val(),n=$("#changeSchedule #changeSchedule_timeto").val(),o=60*$("#changeSchedule #changeSchedule_plan").val(),c=$(".alterDate").val();""===e||""===t||""===a||""===l||""===n||""===o||""===c?alert("변경하려고 하는 정확한 시간을 입력해주세요."):$.ajax({url:"/oauth/counseling/texttime/reservation/",type:"POST",cache:!1,timeout:3e4,contentType:"application/json; charset=UTF-8",dataType:"json",data:JSON.stringify({type:"userAlter",roomNumber:e,modifyDate:t,alterCount:o,alterDate:c,alterType:"texttime",userType:"personal"}),success:function(e){"Y"==e.result?(alert(e.msg),window.location.reload(!0)):alert(e.msg)}})}),$(".deleteChange").click(function(){var e=$("#changeSchedule .numberOfRoom").val(),t=$("#changeSchedule .changeDate").val();""===e||""===t?alert("변경하려고 하는 정확한 시간을 입력해주세요."):$.ajax({url:"/oauth/counseling/texttime/reservation/",type:"POST",cache:!1,timeout:3e4,contentType:"application/json; charset=UTF-8",dataType:"json",data:JSON.stringify({type:"userCancel",roomNumber:e,cancelDate:t,userType:"personal"}),success:function(e){"Y"==e.result?(alert(e.msg),window.location.reload(!0)):alert(e.msg)}})});
